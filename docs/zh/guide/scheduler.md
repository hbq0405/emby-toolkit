# 任务中心

这里集中了几乎所有本工具的功能性任务。

## 任务链

- **高频任务链**：此任务链适合放置需要频繁更新的任务，以保证数据的时效性。建议顺序： [刷新智能追剧] -> [刷新演员订阅] -> [刷新原生合集] -> [刷新自建合集] -> [统一订阅处理]
- **低频任务链**：此任务链适合放置消耗资源较多，例如全量扫描、封面生成和数据清理等。建议任务： [同步媒体数据]、[同步演员数据]、[演员数据补充]、[中文化角色名]、[中文化演员名]、[全量刷洗剧集]等。

任务链是有序列表，按序执行并写入任务状态与日志。

## 重要任务详解

- 同步媒体数据：为所有在库媒体项从TMDb拉取最新元数据并同步到本地数据库
- 同步演员数据：把Emby所有演员同步到本地数据库
- 同步用户数据：把Emby所有用户的数据同步到本地数据库
- 演员数据补充：为本地数据库演员从TMDb补充详细元数据
- 中文化演员名：顾名思义
- 中文化角色名：同上
- 刷新智能追剧：为所有在追剧集刷新最新元数据
- 刷新演员订阅：为所有订阅的演员刷新最新数据用以获取订阅
- 刷新自建合集：为榜单类自建合集获取最新榜单
- 统一订阅处理：处理所有订阅请求、超时订阅、超时复活等
- 扫描监控目录：查漏补缺，防止实时监控有漏网之鱼
- 生成媒体向量：为所有媒体项生成智能推荐所需数据

## 任务队列规则

- 任务互斥：同一时间只执行一个后台任务。
- 支持中止：通过 API 或 UI 发送停止任务请求。
- 进度反馈：任务执行过程写入前端日志队列。

## Cron 示例

```text
0 2 * * *      # 每天凌晨 2 点
0 5 * * 0      # 每周日凌晨 5 点
*/30 * * * *   # 每 30 分钟
0 7-23/5 * * * # 早七点到晚十一点，每五个小时执行一次
```
